(function(b){b.fn.extend({tableExport:function(h){var p={separator:",",ignoreColumn:[],tableName:"yourTableName",sheetName:"sheet1",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"};var h=b.extend(p,h);var e=this;if(p.type=="csv"||p.type=="txt"){var g="";b(e).find("thead").find("tr").each(function(){g+="\n";b(this).filter(":visible").find("th").each(function(v,w){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){g+='"'+m(b(this))+'"'+p.separator}}});g=b.trim(g);g=b.trim(g).substring(0,g.length-1)});b(e).find("tbody").find("tr").each(function(){g+="\n";b(this).filter(":visible").find("td").each(function(v,w){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){g+='"'+m(b(this))+'"'+p.separator}}});g=b.trim(g).substring(0,g.length-1)});if(p.consoleLog=="true"){console.log(g)}var d="base64,"+b.base64({data:g,type:0});window.open("data:application/"+p.type+";filename=exportData;"+d)}else{if(p.type=="sql"){var g="INSERT INTO `"+p.tableName+"` (";b(e).find("thead").find("tr").each(function(){b(this).filter(":visible").find("th").each(function(v,w){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){g+="`"+m(b(this))+"`,"}}});g=b.trim(g);g=b.trim(g).substring(0,g.length-1)});g+=") VALUES ";b(e).find("tbody").find("tr").each(function(){g+="(";b(this).filter(":visible").find("td").each(function(v,w){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){g+='"'+m(b(this))+'",'}}});g=b.trim(g).substring(0,g.length-1);g+="),"});g=b.trim(g).substring(0,g.length-1);g+=";";if(p.consoleLog=="true"){console.log(g)}var d="base64,"+b.base64({data:g,type:0});window.open("data:application/sql;filename=exportData;"+d)}else{if(p.type=="json"){var f=[];b(e).find("thead").find("tr").each(function(){var w="";var v=[];b(this).filter(":visible").find("th").each(function(x,y){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(x)==-1){v.push(m(b(this)))}}});f.push(v)});var q=[];b(e).find("tbody").find("tr").each(function(){var w="";var v=[];b(this).filter(":visible").find("td").each(function(x,y){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(x)==-1){v.push(m(b(this)))}}});q.push(v)});var s=[];s.push({header:f,data:q});if(p.consoleLog=="true"){console.log(JSON.stringify(s))}var d="base64,"+b.base64({data:JSON.stringify(s),type:0});window.open("data:application/json;filename=exportData;"+d)}else{if(p.type=="xml"){var i='<?xml version="1.0" encoding="utf-8"?>';i+="<tabledata><fields>";b(e).find("thead").find("tr").each(function(){b(this).filter(":visible").find("th").each(function(v,w){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){i+="<field>"+m(b(this))+"</field>"}}})});i+="</fields><data>";var o=1;b(e).find("tbody").find("tr").each(function(){i+='<row id="'+o+'">';var v=0;b(this).filter(":visible").find("td").each(function(w,x){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){i+="<column-"+v+">"+m(b(this))+"</column-"+v+">"}}v++});o++;i+="</row>"});i+="</data></tabledata>";if(p.consoleLog=="true"){console.log(i)}var d="base64,"+b.base64({data:i,type:0});window.open("data:application/xml;filename=exportData;"+d)}else{if(p.type=="excel"||p.type=="doc"||p.type=="powerpoint"){var c="<table>";c+=b(e).html();c+="</table>";if(p.consoleLog=="true"){console.log(c)}var j="<!DOCTYPE html><html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+p.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";j+="<head>";j+="<!--[if gte mso 9]>";j+="<xml>";j+="<x:ExcelWorkbook>";j+="<x:ExcelWorksheets>";j+="<x:ExcelWorksheet>";j+="<x:Name>";j+=p.sheetName;j+="</x:Name>";j+="<x:WorksheetOptions>";j+="<x:DisplayGridlines/>";j+="</x:WorksheetOptions>";j+="</x:ExcelWorksheet>";j+="</x:ExcelWorksheets>";j+="</x:ExcelWorkbook>";j+="</xml>";j+="<![endif]-->";j+="</head>";j+="<body>";j+=c;j+="</body>";j+="</html>";var d="base64,"+b.base64({data:j,type:0});if(navigator.userAgent.indexOf("MSIE")!=-1||navigator.appName.indexOf("Microsoft")!=-1){txtArea1.document.open("application/vnd.ms-excel","replace");txtArea1.document.write(j);txtArea1.document.close();txtArea1.focus();sa=txtArea1.document.execCommand("SaveAs",false,p.tableName+".xls")}else{var l="data:application/vnd.ms-"+p.type+";"+d;a=document.createElement("a");a.download=p.tableName;a.href=l;document.body.appendChild(a);a.click();document.body.removeChild(a)}}else{if(p.type=="png"){html2canvas(b(e),{onrendered:function(w){var v=w.toDataURL("image/png");window.open(v)}})}else{if(p.type=="pdf"){var u=new jsPDF("p","pt","a4",true);u.setFontSize(p.pdfFontSize);var n=p.pdfLeftMargin;b(e).find("thead").find("tr").each(function(){b(this).filter(":visible").find("th").each(function(v,x){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(v)==-1){var w=n+(v*50);u.text(w,20,m(b(this)))}}})});var r=20;var k=1;var t=0;b(e).find("tbody").find("tr").each(function(v,w){rowCalc=v+1;if(rowCalc%26==0){u.addPage();k++;r=r+10}t=(r+(rowCalc*10))-((k-1)*280);b(this).filter(":visible").find("td").each(function(x,z){if(b(this).css("display")!="none"){if(p.ignoreColumn.indexOf(x)==-1){var y=n+(x*50);u.text(y,t,m(b(this)))}}})});u.output("datauri")}}}}}}}function m(v){if(p.htmlContent=="true"){content_data=v.html().trim()}else{content_data=v.text().trim()}if(p.escape=="true"){content_data=escape(content_data)}return content_data}}})})(jQuery);
